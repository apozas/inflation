<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>My Title &mdash; inflation 0.1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> inflation
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="download.html">Download and Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">causalinflation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">inflation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>My Title</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/linkexamples.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="my-title">
<h1>My Title<a class="headerlink" href="#my-title" title="Permalink to this headline"></a></h1>
<dl>
<dt>{</dt><dd><dl>
<dt>“cells”: [</dt><dd><dl>
<dt>{</dt><dd><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“# Examples”</p>
</div></blockquote>
<p>]</p>
</dd>
</dl>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“In this tutorial, we will show different problems that the causalinflation package can solve.”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“## Causal compatibility problemsn”,
“n”,
“The causal compatibility problem aims to answer the question of whether a given probability distribution of outcomes of measurements is compatible with a given causal model. For the following examples, we consider compatibility with a quantum causal model. n”,
“n”,
“<em>TODO</em>: explain more”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 20,
“metadata”: {},
“outputs”: [],
“source”: [</p>
<blockquote>
<div><p>“import causalinflation as cinfn”,
“from causalinflation import InflationProblem, InflationSDPn”,
“n”,
“from examples_utils import feasibility_bisectionn”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“#### The PR boxn”,
“n”,
“TODO: break the code and introduce the problemn”,
“n”,
“add bisection function hidden from the documentation, maybe in example_utils.py”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 21,
“metadata”: {},
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“name”: “stdout”,
“output_type”: “stream”,
“text”: [</p>
<blockquote>
<div><p>“Critical visibility:     0.7071n”,
“Infeasibility certificate: n”,
” -201487.332*p(00|00) - 201493.109*p(00|01) - 201493.109*p(00|10) + 201492.612*p(00|11) + 201489.909*pA(0|0) + 1.0*pA(0|1) + 201489.909*pB(0|0) + 1.0*pB(0|1) + 41739.738 ≥ 0n”</p>
</div></blockquote>
<p>]</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“source”: [</p>
<blockquote>
<div><p>“from causalinflation.useful_distributions import P_PRbox_arrayn”,
“n”,
“InfProb = InflationProblem( dag={&quot;h1&quot;: [&quot;v1&quot;, &quot;v2&quot;]},n”,
”                            outcomes_per_party=[2, 2],n”,
”                            settings_per_party=[2, 2],n”,
”                            inflation_level_per_source=[1],n”,
”                            names=[‘A’, ‘B’])n”,
“InfSDP = InflationSDP(InfProb, commuting=False, verbose=0)n”,
“InfSDP.generate_relaxation(column_specification=’npa1’)n”,
“n”,
“InfSDP, critical_vis = feasibility_bisection(InfSDP, P_PRbox_array, verbose=0)n”,
“n”,
“print(&quot;Critical visibility:&quot;, &quot;{:10.4g}&quot;.format(critical_vis))n”,
“print(&quot;Infeasibility certificate: \n&quot;, InfSDP.dual_certificate_as_symbols_probs,n”,
”                                       &quot;≥&quot;, 0)”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: []</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“#### The 2PR distribution in the bilocal scenarion”,
“n”,
“TODO: break the code and introduce the problem”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 22,
“metadata”: {},
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“name”: “stdout”,
“output_type”: “stream”,
“text”: [</p>
<blockquote>
<div><p>“max(min eigval):  1.393e-09 tvisibility = 0 0.5n”,
“Critical visibility:       0.75n”</p>
</div></blockquote>
<p>]</p>
</dd>
</dl>
<p>},
{</p>
<blockquote>
<div><p>“ename”: “AttributeError”,
“evalue”: “‘int’ object has no attribute ‘dual_certificate_as_symbols_probs’”,
“output_type”: “error”,
“traceback”: [</p>
<blockquote>
<div><p>“u001b[1;31m—————————————————————————u001b[0m”,
“u001b[1;31mAttributeErroru001b[0m                            Traceback (most recent call last)”,
“u001b[1;32m~\AppData\Local\Temp/ipykernel_30420/222825797.pyu001b[0m in u001b[0;36m&lt;module&gt;u001b[1;34mu001b[0mnu001b[0;32m     14u001b[0m u001b[1;33mu001b[0mu001b[0mnu001b[0;32m     15u001b[0m u001b[0mprintu001b[0mu001b[1;33m(u001b[0mu001b[1;34m&quot;Critical visibility:&quot;u001b[0mu001b[1;33m,u001b[0m u001b[1;34m&quot;{:10.4g}&quot;u001b[0mu001b[1;33m.u001b[0mu001b[0mformatu001b[0mu001b[1;33m(u001b[0mu001b[0mcritical_visu001b[0mu001b[1;33m)u001b[0mu001b[1;33m)u001b[0mu001b[1;33mu001b[0mu001b[1;33mu001b[0mu001b[0mnu001b[1;32m—&gt; 16u001b[1;33m print(&quot;Infeasibility certificate: \n&quot;, InfSDP.dual_certificate_as_symbols_probs,nu001b[0mu001b[0;32m     17u001b[0m                                        &quot;≥&quot;, 0)n”,
“u001b[1;31mAttributeErroru001b[0m: ‘int’ object has no attribute ‘dual_certificate_as_symbols_probs’”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>}</p>
</div></blockquote>
<p>],
“source”: [</p>
<blockquote>
<div><p>“from causalinflation.useful_distributions import P_2PR_arrayn”,
“n”,
“InfProb = InflationProblem( dag={&quot;h1&quot;: [&quot;v1&quot;, &quot;v2&quot;],n”,
”                                 &quot;h2&quot;: [&quot;v2&quot;, &quot;v3&quot;]},n”,
”                            outcomes_per_party=[2, 2, 2],n”,
”                            settings_per_party=[2, 2, 2],n”,
”                            inflation_level_per_source=[2, 2],n”,
”                            names=[‘A’, ‘B’, ‘C’])n”,
“n”,
“InfSDP = InflationSDP(InfProb, commuting=True, verbose=0)n”,
“InfSDP.generate_relaxation(column_specification=’npa3’, max_monomial_length=2)n”,
“n”,
“InfSDP, critical_vis = feasibility_bisection(InfSDP, P_2PR_array, verbose=1)n”,
“n”,
“print(&quot;Critical visibility:&quot;, &quot;{:10.4g}&quot;.format(critical_vis))n”,
“print(&quot;Infeasibility certificate: \n&quot;, InfSDP.dual_certificate_as_symbols_probs,n”,
”                                       &quot;≥&quot;, 0)”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: null,
“metadata”: {},
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><dl>
<dt>“data”: {</dt><dd><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>“0”</p>
</dd>
</dl>
<p>]</p>
</dd>
</dl>
<p>},
“execution_count”: 15,
“metadata”: {},
“output_type”: “execute_result”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“source”: [</p>
<blockquote>
<div><p>“InfSDP”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“#### The W distributionn”,
“n”,
“TODO: break the code and introduce the problem”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: null,
“metadata”: {},
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“name”: “stdout”,
“output_type”: “stream”,
“text”: [</p>
<blockquote>
<div><p>“max(min eigval):   0.004188 tvisibility = 0 0.5n”,
“max(min eigval):   0.001165 tvisibility = 1 0.75n”,
“max(min eigval):  -0.001274 tvisibility = 2 0.875n”,
“max(min eigval):  0.0006713 tvisibility = 3 0.8125n”,
“max(min eigval):  0.0001666 tvisibility = 4 0.8438n”,
“max(min eigval): -0.0004739 tvisibility = 5 0.8594n”,
“max(min eigval): -0.0001339 tvisibility = 6 0.8516n”,
“max(min eigval):  2.187e-05 tvisibility = 7 0.8477n”,
“max(min eigval): -5.472e-05 tvisibility = 8 0.8496n”,
“max(min eigval): -1.609e-05 tvisibility = 9 0.8486n”,
“max(min eigval):  2.972e-06 tvisibility = 10 0.8481n”,
“max(min eigval): -6.541e-06 tvisibility = 11 0.8484n”,
“max(min eigval): -1.779e-06 tvisibility = 12 0.8483n”,
“max(min eigval):  5.974e-07 tvisibility = 13 0.8482n”,
“Final values and last valid certificate:n”,
“max(min eigval):  5.974e-07 tvm = 14     0.8482n”,
“145.768*p(000|000)*pA(0|0) + 145.769*p(000|000)*pB(0|0) + 145.757*p(000|000)*pC(0|0) + 921.574*p(000|000) - 122.504*pA(0|0)**2 - 112.285*pA(0|0)*pAB(00|00) - 112.149*pA(0|0)*pAC(00|00) - 553.411*pA(0|0)*pB(0|0)*pC(0|0) + 1293.356*pA(0|0)*pB(0|0) - 580.673*pA(0|0)*pBC(00|00) + 1293.124*pA(0|0)*pC(0|0) - 1105.698*pA(0|0) + 313.48*pAB(00|00)**2 + 202.786*pAB(00|00)*pAC(00|00) - 112.258*pAB(00|00)*pB(0|0) + 202.78*pAB(00|00)*pBC(00|00) - 580.667*pAB(00|00)*pC(0|0) + 1.066*pAB(00|00) + 313.433*pAC(00|00)**2 - 580.747*pAC(00|00)*pB(0|0) + 202.818*pAC(00|00)*pBC(00|00) - 112.177*pAC(00|00)*pC(0|0) + 1.0*pAC(00|00) - 122.527*pB(0|0)**2 - 112.227*pB(0|0)*pBC(00|00) + 1293.293*pB(0|0)*pC(0|0) - 1105.759*pB(0|0) + 313.504*pBC(00|00)**2 - 112.338*pBC(00|00)*pC(0|0) + 1.058*pBC(00|00) - 122.482*pC(0|0)**2 - 1105.672*pC(0|0) + 1142.473 ≥ 0n”</p>
</div></blockquote>
<p>]</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“source”: [</p>
<blockquote>
<div><p>“from causalinflation.useful_distributions import P_W_arrayn”,
“n”,
“n”,
“InfProb = InflationProblem(dag={&quot;h2&quot;: [&quot;v1&quot;, &quot;v2&quot;],n”,
”                                &quot;h3&quot;: [&quot;v1&quot;, &quot;v3&quot;],n”,
”                                &quot;h1&quot;: [&quot;v2&quot;, &quot;v3&quot;]},n”,
”                           outcomes_per_party=[2, 2, 2],n”,
”                           settings_per_party=[1, 1, 1],n”,
”                           inflation_level_per_source=[2, 2, 2],n”,
”                           names=[‘A’, ‘B’, ‘C’])n”,
“n”,
“InfSDP = InflationSDP(InfProb, commuting=False, verbose=0)n”,
“InfSDP.generate_relaxation(column_specification=’npa2’)n”,
“n”,
“tol_vis = 1e-4n”,
“v0, v1 = 0, 1n”,
“vm = (v0 + v1)/2n”,
“n”,
“InfSDP.verbose = 0n”,
“n”,
“iteration = 0n”,
“certificate = 0n”,
“while abs(v1 - v0) &gt;= tol_vis and iteration &lt; 20:n”,
”    p = P_W_array(visibility=vm)n”,
”    InfSDP.set_distribution(p, use_lpi_constraints=True)n”,
”    InfSDP.solve()n”,
“n”,
”    print(&quot;max(min eigval):&quot;, &quot;{:10.4g}&quot;.format(n”,
”        InfSDP.primal_objective), &quot;\tvisibility =&quot;, iteration, &quot;{:.4g}&quot;.format(vm))n”,
”    iteration += 1n”,
”    if InfSDP.primal_objective &gt;= 0:n”,
”        v0 = vmn”,
”        vm = (v0 + v1)/2n”,
”    elif InfSDP.primal_objective &lt; 0:n”,
”        v1 = vmn”,
”        vm = (v0 + v1)/2n”,
”        certificate = InfSDP.dual_certificate_as_symbols_probsn”,
”    if abs(InfSDP.primal_objective) &lt;= 1e-7:n”,
”        breakn”,
“n”,
“print(&quot;Final values and last valid certificate:&quot;)n”,
“print(&quot;max(min eigval):&quot;, &quot;{:10.4g}&quot;.format(n”,
”    InfSDP.primal_objective), &quot;\tvm =&quot;, iteration, &quot;{:10.4g}&quot;.format(vm))n”,
“print(certificate, &quot;≥&quot;, 0)n”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“## Optimisation problems”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“Given a function of the probability distribution, we want to find the maximum over the set of probability distributions compatible with the causal model. This type of problem can also be tackled with causalinflation by optimising over the semidefinite relaxation of the problem.n”,
“n”,
“TODO: refine statement”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“#### The Svetlichny distributionn”,
“n”,
“TODO: break the code and introduce the problem”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: null,
“metadata”: {},
“outputs”: [],
“source”: [</p>
<blockquote>
<div><p>“from causalinflation.quantum.general_tools import to_numbers, to_namen”,
“import numpy as npn”,
“import itertoolsn”,
“import sympy as sp”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: null,
“metadata”: {},
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“name”: “stdout”,
“output_type”: “stream”,
“text”: [</p>
<blockquote>
<div><p>“5.656854245790322n”</p>
</div></blockquote>
<p>]</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“source”: [</p>
<blockquote>
<div><p>“InfProb = InflationProblem( dag={&quot;h1&quot;: [&quot;v1&quot;, &quot;v2&quot;],n”,
”                                 &quot;h2&quot;: [&quot;v1&quot;, &quot;v3&quot;],n”,
”                                 &quot;h3&quot;: [&quot;v2&quot;, &quot;v3&quot;]},n”,
”                            outcomes_per_party=[2, 2, 2],n”,
”                            settings_per_party=[2, 2, 2],n”,
”                            inflation_level_per_source=[2, 2, 2],n”,
”                            names=[‘A’, ‘B’, ‘C’] )n”,
“n”,
“InfSDP = InflationSDP(InfProb, commuting=False, verbose=0)n”,
“n”,
“InfSDP.build_columns(‘physical222’, max_monomial_length=2)n”,
“cols_S2 = InfSDP.generating_monomialsn”,
“InfSDP.build_columns(‘local1’)n”,
“cols_loc1 = InfSDP.generating_monomialsn”,
“n”,
“cols_S2_name = [to_name(np.array(m), InfProb.names) for m in cols_S2[1:]]n”,
“cols_loc1_name = [to_name(np.array(m), InfProb.names) for m in cols_loc1[1:]]n”,
“cols = cols_S2_namen”,
“for m in cols_loc1_name:n”,
”    if m not in cols_S2_name:n”,
”        cols.append(m)n”,
“#cols = cols_S2_name.union(cols_loc1_name)n”,
“cols_num = [[0]]n”,
“for m in cols:n”,
”    cols_num.append(to_numbers(m, InfProb.names))n”,
“n”,
“InfSDP.generate_relaxation(column_specification=[[], [0], [1], [2],n”,
”                                                 [0, 0], [0, 1], [1, 1],n”,
”                                                 [0, 2], [2, 2], [1, 2]])n”,
“n”,
“measurements = InfSDP.measurements n”,
“A0 = sp.S.One - 2*measurements[0][0][0][0]n”,
“A1 = sp.S.One - 2*measurements[0][0][1][0]n”,
“B0 = sp.S.One - 2*measurements[1][0][0][0]n”,
“B1 = sp.S.One - 2*measurements[1][0][1][0]n”,
“C0 = sp.S.One - 2*measurements[2][0][0][0]n”,
“C1 = sp.S.One - 2*measurements[2][0][1][0]n”,
“objective = sp.expand(A1*B0*C0 + A0*B1*C0 + A0*B0*C1 - A1*B1*C1 - n”,
”                      A0*B1*C1 - A1*B0*C1 - A1*B1*C0 + A0*B0*C0 )n”,
“n”,
“InfSDP.set_objective(objective=objective)  # By default it maximizesn”,
“n”,
“InfSDP.solve(interpreter=&quot;MOSEKFusion&quot;)n”,
“n”,
“print(InfSDP.primal_objective)n”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“#### The distance to a particular distributionn”,
“n”,
“TODO: break the code and introduce the problem”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: null,
“metadata”: {},
“outputs”: [],
“source”: [</p>
<blockquote>
<div><p>“from causalinflation.useful_distributions import P_W_arrayn”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: null,
“metadata”: {},
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“name”: “stdout”,
“output_type”: “stream”,
“text”: [</p>
<blockquote>
<div><p>“0.33333333121984077n”</p>
</div></blockquote>
<p>]</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“source”: [</p>
<blockquote>
<div><p>“outcomes_per_party = [2, 2, 2]n”,
“settings_per_party = [1, 1, 1]n”,
“InfProb = InflationProblem( dag={&quot;h1&quot;: [&quot;v1&quot;, &quot;v2&quot;],n”,
”                                 &quot;h2&quot;: [&quot;v1&quot;, &quot;v3&quot;],n”,
”                                 &quot;h3&quot;: [&quot;v2&quot;, &quot;v3&quot;]},n”,
”                            outcomes_per_party=outcomes_per_party,n”,
”                            settings_per_party=settings_per_party,n”,
”                            inflation_level_per_source=[2, 2, 2],n”,
”                            names=[‘A’, ‘B’, ‘C’] )n”,
“n”,
“InfSDP = InflationSDP(InfProb, commuting=False, verbose = 0)n”,
“InfSDP.generate_relaxation(column_specification=’local1’,)n”,
“n”,
“p_W = P_W_array(visibility=1.0)n”,
“n”,
“measurements = InfSDP.measurements  # This reads as measurements[party][inflation_source][setting][outcome]. TODO remove &quot;inflation_source&quot; as the user doesnt caren”,
“n”,
“sum_abc_pW_squared = np.multiply(p_W,p_W).sum()n”,
“n”,
“sum_abc_p_obs_times_p_W = 0n”,
“sum_abc_p_obs_squared = 0n”,
“n”,
“for a, b, c in itertools.product(<a href="#id1"><span class="problematic" id="id2">*</span></a>[range(o) for o in outcomes_per_party]):n”,
”    # &lt; A_11 * A_22 * B_11 * B_22 * C_11 * C_22 &gt;n”,
”    p_obs_squared = 1n”,
”    p_obs_squared <a href="#id3"><span class="problematic" id="id4">*</span></a>= measurements[0][0][0][a] * measurements[0][3][0][a] if a==0 else (1-measurements[0][0][0][0]) * (1-measurements[0][3][0][0])n”,
”    p_obs_squared <a href="#id5"><span class="problematic" id="id6">*</span></a>= measurements[1][0][0][b] * measurements[1][3][0][b] if b==0 else (1-measurements[1][0][0][0]) * (1-measurements[1][3][0][0])n”,
”    p_obs_squared <a href="#id7"><span class="problematic" id="id8">*</span></a>= measurements[2][0][0][c] * measurements[2][3][0][c] if c==0 else (1-measurements[2][0][0][0]) * (1-measurements[2][3][0][0])n”,
“n”,
”    sum_abc_p_obs_squared += p_obs_squaredn”,
“n”,
”    # p_W(a,b,c) * &lt; A_11 * B_11 * C_11 &gt;n”,
”    p_obs_times_p_W = p_W[a, b, c, 0, 0, 0]n”,
”    p_obs_times_p_W <a href="#id9"><span class="problematic" id="id10">*</span></a>= measurements[0][0][0][0] if a==0 else (1-measurements[0][0][0][0])n”,
”    p_obs_times_p_W <a href="#id11"><span class="problematic" id="id12">*</span></a>= measurements[1][0][0][0] if b==0 else (1-measurements[1][0][0][0])n”,
”    p_obs_times_p_W <a href="#id13"><span class="problematic" id="id14">*</span></a>= measurements[2][0][0][0] if c==0 else (1-measurements[2][0][0][0])n”,
“n”,
”    sum_abc_p_obs_times_p_W += p_obs_times_p_Wn”,
“n”,
“n”,
“objective = sum_abc_pW_squared + sum_abc_p_obs_squared - 2 * sum_abc_p_obs_times_p_Wn”,
“objective = sp.expand(objective)n”,
“n”,
“InfSDP.set_objective(objective=objective, direction=’min’)  # By default it maximizesn”,
“InfSDP.solve(interpreter=&quot;MOSEKFusion&quot;)n”,
“n”,
“print(InfSDP.primal_objective)”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“## Appendix: How to customize the generating setn”,
“n”,
“In this tutorial we will showcase how to customize the generating set of monomials.n”,
“n”,
“We can use the built-in functions to construct a generating set according to several hierarchies. To showcase this, let us first look at a simple scenario of only two parties, Alice and Bob, sharing a quantum state.”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: null,
“metadata”: {},
“outputs”: [],
“source”: [</p>
<blockquote>
<div><p>“InfProb = InflationProblem(dag= {&quot;h1&quot;: [&quot;v1&quot;, &quot;v2&quot;]},n”,
”                           outcomes_per_party=[2, 2],n”,
”                           settings_per_party=[2, 2],n”,
”                           inflation_level_per_source=[1])n”,
“InfSDP = InflationSDP(InfProb, commuting=False, verbose=0)”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“These are all the measurement operators:”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: null,
“metadata”: {},
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><dl>
<dt>“data”: {</dt><dd><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>“[[[[A_1_0_0], [A_1_1_0]]], [[[B_1_0_0], [B_1_1_0]]]]”</p>
</dd>
</dl>
<p>]</p>
</dd>
</dl>
<p>},
“execution_count”: 24,
“metadata”: {},
“output_type”: “execute_result”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“source”: [</p>
<blockquote>
<div><p>“meas = InfSDP.measurementsn”,
“meas”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“As a reminder, the indices are interpreted as follows: the last two give the measurement setting and measurement output, and the rest represent on which copy of the source the operator is acting. For example, <cite>A_1_1_0</cite> represents the projection onto copy 1 of source 1 with measurement setting $x=1$ and measurement outcome $a=0$.n”,
“n”,
“Now let us look at a few examples of hierarchies. The first is the NPA levels”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: null,
“metadata”: {},
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“name”: “stdout”,
“output_type”: “stream”,
“text”: [</p>
<blockquote>
<div><p>“[1, A_1_0_0, A_1_1_0, B_1_0_0, B_1_1_0, A_1_0_0*B_1_0_0, A_1_0_0*B_1_1_0, A_1_1_0*B_1_0_0, A_1_1_0*B_1_1_0]n”</p>
</div></blockquote>
<p>]</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“source”: [</p>
<blockquote>
<div><p>“InfSDP.build_columns(column_specification=’local1’)n”,
“print(InfSDP.generating_monomials_sym)”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>}</p>
</dd>
</dl>
<p>],
“metadata”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“interpreter”: {</dt><dd><p>“hash”: “5c2f8743b7bffe768e49b7326944f1db750a54ae5a22907e70233feb4ab21afd”</p>
</dd>
</dl>
<p>},
“kernelspec”: {</p>
<blockquote>
<div><p>“display_name”: “Python 3.8.5 (‘base’)”,
“language”: “python”,
“name”: “python3”</p>
</div></blockquote>
<p>},
“language_info”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“codemirror_mode”: {</dt><dd><p>“name”: “ipython”,
“version”: 3</p>
</dd>
</dl>
<p>},
“file_extension”: “.py”,
“mimetype”: “text/x-python”,
“name”: “python”,
“nbconvert_exporter”: “python”,
“pygments_lexer”: “ipython3”,
“version”: “3.8.5”</p>
</div></blockquote>
<p>},
“orig_nbformat”: 4</p>
</div></blockquote>
<p>},
“nbformat”: 4,
“nbformat_minor”: 2</p>
</dd>
</dl>
<p>}</p>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Emanuel-Cristian Boghiu, Alejandro Pozas-Kerstjens.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>